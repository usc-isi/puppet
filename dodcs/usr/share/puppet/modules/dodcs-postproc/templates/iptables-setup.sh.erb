#!/bin/bash

/sbin/iptables -I INPUT 1 -p tcp --dport 5672 -j ACCEPT
/sbin/iptables -I INPUT 1 -p tcp --dport 3306 -j ACCEPT
/sbin/iptables -I INPUT 1 -p tcp --dport 3260 -j ACCEPT
/sbin/iptables -I INPUT 1 -p tcp --dport 9292 -j ACCEPT
/sbin/iptables -I INPUT 1 -p tcp --dport 6080 -j ACCEPT
/sbin/iptables -I INPUT 1 -p tcp --dport 8773 -j ACCEPT
/sbin/iptables -I INPUT 1 -p tcp --dport 8774 -j ACCEPT
/sbin/iptables -I INPUT 1 -p udp --dport 67 -j ACCEPT

#The ports used by Keystone, OpenStack must not be blocked by the firewall.
#Run the following commands on all of the nodes:
/sbin/iptables -I INPUT 1 -p tcp --dport 5000 -j ACCEPT
/sbin/iptables -I INPUT 1 -p tcp --dport 35357 -j ACCEPT

#After performing the requested iptables commands, the current state of
#the iptables firewall
/sbin/iptables-save > /etc/sysconfig/iptables
